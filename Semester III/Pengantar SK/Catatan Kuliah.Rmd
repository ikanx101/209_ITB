---
title: "SK500x PENGANTAR SAINS KOMPUTASI"
subtitle: | 
    | Catatan Kuliah
    | Menggunakan R
author: | 
    | Ikang FADHLI
    | ikanx101.com
date: "`r format(Sys.time(), '%d %B %Y')`"
fontsize: 12pt
output: 
  pdf_document:
    number_sections: true
    toc: false
    fig_width: 7
    fig_height: 4
    fig_caption: true
    highlight: tango
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyfoot[CO,CE]{20921004@mahasiswa.itb.ac.id}
- \fancyfoot[LE,RO]{hal \thepage}  

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)

options(scipen = 999)

rm(list=ls())
```

\newpage
\tableofcontents
\newpage
\listoffigures
\newpage

# _Unconstrained Growth and Decay_

Pada pembahasan kali ini kita akan membahas model dimana _rate_ perubahan itu proporsional dengan kondisi sekarang. Sebelumnya, mari kita bahas konsep dasar tentang __perubahan__ sebagai berikut:

## Konsep Dasar

### _Rate of Change_

Misalkan dalam suatu gerak benda, $y$ menandakan posisi dinotasikan sebagai fungsi $(s)$ terhadap waktu $(t)$.

Misalkan suatu mobil bergerak dari $t=0$ h pada $s(0) = 0$ km sampai $t=10$ h, $s(10) = 70$ km.

__Rata-rata kecepatan__ bisa didefinisikan sebagai perubahan posisi $(\Delta s)$ terhadap perubahan waktu $(\Delta t)$. Pada kasus di atas:

$$
\text{average velocity} = \frac{\Delta s}{\Delta t} = \frac{70 - 0}{10 - 0} = 7 \frac{km}{h}
$$

Jika kita memperkecil perubahan $\Delta$, kita akan dapatkan ___instantaneous rate of change___.

### _Instantaneous Rate of Change_

Dari sini baru muncul yang namanya _derivative_ atau turunan.

## _Differential Equation_

Kita diperkenalkan kepada __Malthusian Model__ untuk pertumbuhan penduduk, yakni:

$$
\frac{dP}{dt} \sim P
$$

$$
\frac{dP}{dt} = rP, \\
r \text{ is growth rate}
$$


### Contoh Kasus

Misalkan pada $t=0$, populasi bakteri ada sebanyak 100 dengan _instantaneous growth rate_ sebesar $10 \%$ di mana unit waktu yang digunakan adalah jam. Kita bisa tuliskan:

$$
\frac{dP}{dt} = 0.1P, P(0) = 100
$$

## _Finite Difference Equation_

Komputer tidak bisa menyelesaikan masalah kontinu, oleh karena itu dibutuhkan pendekatan diskrit. Maka untuk kasus model di atas, kita bisa membuat persamaan beda agar kita bisa menghitungnya.

Bentuk umumnya adalah sebagai berikut:

$$
\text{new value} = \text{old values} + \text{change in value}
$$

### Algoritma

```
initialize
  sim_length
  population
  rate
  dt
compute:
  rate_per_step = rate * dt
  num_iter = sim_length / dt
for i: 1 to num_iter
  population = population + rate_per_step * population
  t = i * dt
  print(t, population)
```

### Penyelesaian Contoh Kasus

Kita akan selesaikan contoh kasus dengan algoritma yang ada pada bagian sebelumnya.

```{r,warning=FALSE,message=FALSE}
# define
sim_length = 1
population = 100
rate = 0.1
dt = .05

# compute
rate_per_step = rate * dt
num_iter = sim_length / dt

for(i in 1:num_iter){
  population = population + rate_per_step * population
  t = i*dt
  print(paste("Populasi = ",population," pada t = ",t))
}
```


Berikut adalah hasil simulasi untuk $t$ yang lebih panjang lagi.

```{r,echo=FALSE,warning=FALSE,message=FALSE,fig.align='center',fig.retina=10,fig.cap="Hasil Simulasi Pertumbuhan Bakteri"}
rm(list=ls())
# define
sim_length = 30
population = 100
rate = 0.1
dt = .005

# compute
rate_per_step = rate * dt
num_iter = sim_length / dt

hasil = data.frame(pop = NA,
                   t = NA)
hasil[1,] = list(population,0)
j = 2

for(i in 1:num_iter){
  population = population + rate_per_step * population
  t = i*dt
  hasil[j,] = list(population,t)
  j = j+1
}

hasil %>% 
  ggplot(aes(x = t,
             y = pop)) +
  geom_line(color = "steelblue") +
  labs(title = "Hasil Simulasi Pertumbuhan Bakteri",
       subtitle = "Menggunakan Metode Beda",
       x = "Time (hours)",
       y = "Population") +
  theme_classic()
```



\newpage
\newpage


# Pertumbuhan Terbatas

Populasi secara teori memiliki kemampuan untuk terus bertumbuh secara eksponensial. Namun lingkungan memiliki daya dukung sehingga pertumbuhan yang terjadi menjadi terbatas. Di sini diperkenalkan konsep bernama _carrying capacity_.

Pada __Model Malthus__ sebelumnya, kita miliki:

$$\frac{dP}{dt} = r P$$

dengan solusi analitik:

$$P = P_0 e^{rt}$$

di mana $P_0$ adalah populasi awal.

## Model Baru dengan _Carrying Capacity_

Dalam model baru, untuk populasi awal yang jauh lebih kecil dari kapasitas lingkungan, populasi akan bertambah serupa dengan model tak terbatas.

Namun, seiring dengan mendekatnya ukuran populasi dengan kapasitas lingkungan, pertumbuhan akan semakin berkurang. Dekat dengan kapasitas lingkungan, banyaknya kematian harus serupa dengan banyaknya kelahiran, agar populasi cenderung konstan.

Untuk memperoleh pertumbuhan yang diperlambat, kita dapat mengukur banyaknya kematian sebagai hasil kali dengan banyaknya kelahiran yang dimodelkan sebagai $r P$.

Ketika populasi sangat kecil, hasil kali tersebut tersebut harusnya mendekati nol, karena hanya sedikit individu yang mati. 

Ketika populasi dekat dengan kapasitas lingkungan, hasil kali tersebut haruslah mendekati satu. Jika $D$ menyatakan banyaknya kematian dan $M$ menyatakan kapasitas lingkungan, maka kita dapat memodelkan laju perubahan kematian sebagai:

$$\frac{dP}{dt} = (\frac{r P}{M}) P$$

Akibatnya:

$$\frac{dP}{dt} = rP - (\frac{r P}{M}) P = r (1 - \frac{P}{M}) P$$

_Births minus deaths_ 

\newpage

# _Constrained Growth and Decay_

Secara alamiah, pertumbuhan populasi yang bersifat eksponensial tidak tak terbatas. Karena lingkungan punya cara sendiri untuk menopang pertumbuhan populasi tersebut. Contohnya: sumber makanan yang terbatas, adanya _predator_, penyakit, dst.

Pada kenyataannya, populasi akan bisa terus bertumbuh sampai ambang batas tertentu. Selanjutnya, akan selalu berada pada ambang batas tersebut.

## Kapasitas Lingkungan

Ukuran populasi maksimum yang bisa didukung oleh lingkungan disebut dengan __kapasitas lingkungan__ (_carrying capacity_).

Kita telah mengenal model pada bagian sebelumnya:

$$\frac{dP}{dt} = rP$$

dimana $P_0$ adalah populasi awal.

Lalu bagaimana kita memodelkan pertumbuhan terbatas dengan mengikutsertakan _carrying capacity_?

## Model Terbatas

Pada $t_0$, jika populasi masih berada di bawah _carrying capacity_, maka populasi masih bisa bertumbuh. Namun saat mendekat dengan CC, maka pertambahan populasi akan melambat. Semakin mendekat lagi ke CC, banyaknya kematian harus serupa dengan banyaknya kelahiran agar populasi cenderung konstan.

Intinya kita perlu memodelkan pertumbuhan yang melambat.

Konsepnya:

```
new population = growth - death
```

Misalkan $D$ menandakan kematian dan $M$ menandakan CC, maka:

$$\frac{dD}{dt} = (\frac{rP}{M}) P$$

Jika:

- $P$ yang kecil, nilai $D$ akan mendekati nol.
- $P$ yang besar, nilai $D$ akan mendekati _growth_ ($\Delta P$). Laju kematian akan sama dengan laju _growth_.

Akibatnya:

$$
\frac{dP}{dt} = rP - (r \frac{P}{M}) P
$$


$$
\frac{dP}{dt} = r (1 - \frac{P}{M}) P
$$


## Model Final Simulasi Diskrit

Dengan demikian:

$$
\Delta P = (rP(t-\Delta t) \Delta t) - (r \frac{P(t-\Delta t)}{M}) P(t-\Delta t) \Delta t
$$

Persamaan ini disebut dengan __persamaan logistik__.


## Kasus Lain

Bagaimana jika $P_0 > M$ ?

Maka populasi akan menurun (kematian akan lebih besar dibandingkan _growth_) hingga tercapai keseimbangan pada $M$.


### Algoritma

```
initialize
  sim_length
  pop
  rate
  M
  dt
compute:
  rate_per_step = rate * dt
  num_iter = sim_length / dt
for i: 1 to num_iter
  pop = pop + rate_per_step * pop - (rate_per_step * pop / M) * pop
  t = i * dt
  print(t, population)
```

\newpage

# SIR Model

_Suspected_, _infected_, _recovered_ digunakan untuk memodelkan penyebaran penyakit dengan populasi tertutup (tidak ada kelahiran, kematian, imigrasi, dan emigrasi).

## SIR Model untuk $R$

Dalam suatu waktu, orang yang terkena penyakit (misalkan flu) akan sembuh. Maka $R$ akan proporsional ke $I$.

$$\frac{dR}{dt} = a \times I$$

dengan $a$ adalah _recovery rate_. Biasanya $a = \frac{1}{d}$, dimana $d$ adalah _number of days infected_.

## SIR Model untuk $S$

_Suspect_ akan terkena flu saat berinteraksi dengan orang yang sakit $I$.

$$\frac{dS}{dt} = -r \times S \times I$$

dengan $r$ adalah _transmission constant_.

Bagaimana cara menghitung $r$?

Jika:

- $N$ adalah total populasi.
- $k$ adalah banyaknya kontak perhari antara $S$ dan $I$.
- Peluang adanya kontak dengan $S$ adalah $\frac{S}{N}$.
- Peluang orang $S$ terinfeksi saat kontak adalah $b$.

Maka: 

$$\frac{dS}{dt} = - (\frac{k \times b}{N}) \times S \times I$$

## SIR Model untuk $I$

$$\frac{dI}{dt} = -\frac{dS}{dt} - \frac{dR}{dt}$$

\newpage

# _Errors_

Kesalahan yang mungkin terjadi saat komputasi. Beberapa istilah yang penting:

1. _Floating point number_
    - Bilangan real biasa disebut dengan _floating point_.
    - Biasanya ditulis sebagai bilangan desimal dikali 10 pangkat sesuatu $a \times 10^n$.
    - Nilai $a$ tidak boleh __nol__.
    - $a$ disebut __significand__ atau __mantissa__.
    - $n$ disebut __eksponen__.
1. _Significant digit_
    - Semua angka integer selain nol di depan dan belakang pada _significand_.
1. _Precision_
    - Berapa banyak _significant digit_.
1. _Magnitude_
    - $10^n$ dari notasi _floating point_.
    

Ini adalah _computational errors_:

- _Absolute and Relative Errors_
- _Round-off Errors_
- _Arithmetic Errors_
- _Error Propagation_


