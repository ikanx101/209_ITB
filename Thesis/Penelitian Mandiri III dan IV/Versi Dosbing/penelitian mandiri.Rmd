---
title: "PROGRESS UPDATE"
subtitle: "PENELITIAN MANDIRI DALAM SAINS KOMPUTASI III - IV"
author: "Mohammad Rizka Fadhli 20921004"
institute: "Sains Komputasi ITB"
date: "13 Februari 2022"
output:
  beamer_presentation:
    fig_width: 7
    fig_height: 6
    fig_caption: true
    slide_level: 3
    theme: "Szeged"
    colortheme: "beaver"
    fonttheme: "structurebold"
classoption: "aspectratio=169"
toc: false
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
rm(list=ls())
library(dplyr)
```

# RENCANA KERJA

## Rencana Judul Thesis

### Rencana Judul Thesis

___Optimization and Computational Model for Supplier Selection and Raw-Material Composition: Case Study PT. NFI.___

## Target _Output_

### _Planned Output_

#### Penelitian Mandiri III

_Data collection_ dan dokumentasi _production system_.

#### Penelitian Mandiri IV

Model optimisasi yang telah disempurnakan.


# PENELITIAN MANDIRI III

## Masalah Optimisasi

### Masalah Optimisasi

Penentuan keputusan strategis dalam memilih _supplier_ bahan mentah dan menentukan banyaknya bahan mentah yang harus dibeli dari suatu pemasok agar total biaya pembelian seminim mungkin tetapi memenuhi kebutuhan yang ada.

### Kondisi yang Ada Saat Ini

Saat ini pemilihan _supplier_ dan penentuan kuantitas pembelian _raw material_ dilakukan secara manual dengan mempertimbangkan data-data terkait secara mingguan oleh departemen PPIC (_Production Planning and Inventory Control_). Namun jika ada perubahan _demand_ secara mendadak, proses terseut harus dihitung ulang.

Proses perhitungan ini memerlukan waktu yang cukup lama karena banyak faktor yang mempengaruhi.

### Rencana Kerja 

Model optimisasi ini kelak akan diimplementasikan pada departemen PPIC sehingga proses pemilihan supplier dan penentuan kuantitas pembelian _raw material_ bisa dilakukan secara cepat dan tepat. Diharapkan proses bisnis menjadi menjadi lebih efisien dan _cost_ yang ada bisa ditekan lebih baik lagi.

### _Output_ Lain dari Model Optimisasi

Bahasan dalam optimisasi dapat dikategorikan menjadi:

- Pemodelan masalah nyata menjadi masalah optimisasi.
- Pembahasan karakteristik dari masalah optimisasi dan keberadaan solusi dari masalah optimisasi tersebut.
- Pengembangan dan penggunaan algoritma serta analisis numerik untuk mencari solusi dari masalah tersebut.

## Dokumentasi _Production System_

### Rangkaian Produksi

Dalam rangkaian produksi, __NFI__ menggunakan banyak sekali bahan baku. Namun ada beberapa bahan baku utama yang paling sering digunakan. 

Selama ini __NFI__ memesan bahan-bahan baku tersebut secara __langsung tiap bulannya__ dengan besarnya pemesanan disesuaikan dengan:

1. Angka _demand_ atau _forecast_ masing-masing produk yang menggunakan bahan-bahan baku tersebut.
1. _Existing stock_ bahan baku yang ada di gudang bahan baku.
1. _Minimum order_ per jenis bahan baku yang ditetapkan _supplier_.

### Informasi Terkait Pengiriman Bahan Baku 

Pengiriman bahan baku oleh para _supplier_ dilakukan sebanyak __4__ kali dalam sebulan dengan jumlah  sesuai dengan aturan berikut:

- Banyaknya bahan baku pada __pengiriman pertama__ disesuaikan dengan __stok__ ___existing___ dan ___demand___ produk terkait bahan baku tersebut pada minggu I.
- Sedangkan bahan baku gula pada __pengiriman kedua hingga keempat__ dibuat proporsional.
- __Waktu pengiriman dan inspeksi__ adalah selama __17__ hari setelah pemesanan gula sampai akhirnya gula tersebut dapat digunakan untuk produksi. 

__Oleh karena itu, perencanaan pembelian gula dilakukan setidaknya sebulan sebelum gula tersebut akan digunakan.__

### Ilustrasi Pengiriman Bahan Baku

Contoh pada suatu bulan tertentu:

- Kebutuhan bahan baku diperkirakan sebesar __400 ton__.
- Stok _existing_ bahan baku di gudang bahan baku ada __50 ton__.
- Maka __NFI__ perlu memesan bahan baku sebesar __350 ton__.
- Pengiriman dilakukan __4 kali__.
    - Pada minggu I, diperkirakan kebutuhan bahan baku ada sebesar __100 ton__. Oleh karena itu, __pengiriman pertama__ adalah sebesar __50 ton__ saja.
    - Pada minggu II, III, dan IV pengiriman gula adalah proporsional sebesar __100 ton__.
- 

Oleh karena itu, kelak pada model matematika perlu ada _constraints_ terkait hal ini.

### Ilustrasi Pengiriman Bahan Baku

```{r out.width="75%",echo=FALSE,fig.cap="Simplifikasi dari Penggunaan Bahan Baku"}
knitr::include_graphics("ilustrasi.png")
```

### Informasi Terkait Jenis Bahan Baku {.allowframebreaks}

Saat ini, ada __6__ jenis bahan baku yang bisa dipesan ke __6__ _supplier_ yang berbeda. Masing-masing bahan baku digunakan untuk membuat produk tertentu. Informasi lain yang perlu diketahui adalah:

- __Tidak ada kewajiban__ bagi NFI untuk membeli semua jenis bahan baku tersebut. 
- Terkait penggunaan bahan baku:
    - Sebagian kecil dari produk hanya bisa diproduksi dengan __satu jenis bahan baku saja__.
    - Sebagian besar lainnya memungkinkan untuk diproduksi dengan __dua atau lebih jenis bahan baku__.
        - Unit per jenis bahan baku yang digunakan untuk membuat produk adalah sama walau berbeda jenis bahan baku.
- Setidaknya minimal ada __2 jenis bahan baku__ yang dibeli NFI sebagai _back up_ substitusi bahan baku.
- Pembelian bahan baku harus memenuhi _minimum order_ yang ditetapkan oleh _supplier_ __tapi__ jika pembelian di atas _minimum order_ harus dilakukan __pembulatan__. Misalkan:
    - _Minimum order_ adalah __10 ton__, maka:
        - Boleh membeli __11 ton__.
        - Tidak boleh membeli __10.5 ton__.
- Harga masing-masing jenis bahan baku berbeda. Namun untuk lama pengiriman, pada kasus ini semua gula memiliki lama pengiriman yang sama.

### Ilustrasi Alur Pengadaan Bahan Baku: Misal - Gula

Berikut adalah _summary_ alur pengadaan bahan baku gula yang dilakukan Nutrifood:

```{r out.width="75%",echo=FALSE,fig.cap="Simplifikasi dari Penggunaan Bahan Baku"}
knitr::include_graphics("ilustrasi_2.png")
```

### Informasi Terkait Substitusi Bahan Baku

#### Case I: Minimal __2 jenis__ bahan baku sebagai _back up_

Dalam suatu bulan tertentu, untuk memproduksi produk __A__, __B__, dan __C__ dibutuhkan bahan baku $x_1$, $x_2$, __atau__ $x_3$.

Untuk memastikan tidak ada masalah di kemudian hari (sebagai _back up_), maka minimal harus ada __2__ jenis bahan baku yang harus dibeli. Alternatifnya:

1. Membeli $x_1$ dan $x_2$,
1. Membeli $x_1$ dan $x_3$,
1. Membeli $x_2$ dan $x_3$, atau
1. Membeli $x_1$, $x_2$, dan $x_3$.

### Informasi Terkait Substitusi Bahan Baku 

#### Case II: Unit bahan baku yang digunakan __sama__

Dalam suatu bulan tertentu, untuk membuat produk __A__, kita bisa menggunakan:

1. 100 unit $x_1$ atau,
1. 100 unit $x_2$.

Sedangkan untuk membuat produk __B__, kita bisa menggunakan:

1. 100 unit $x_2$ atau,
1. 100 unit $x_3$.

### Informasi Terkait Substitusi Bahan Baku 

#### Case II: Unit bahan baku yang digunakan __sama__

Dari kasus di atas, kita bisa menuliskan bahwa:

1. Kebutuhan bahan baku 1 ada sebesar $x_1 \leq 100$.
1. Kebutuhan bahan baku 2 ada sebesar $x_2 \leq 200$.
1. Kebutuhan bahan baku 3 ada sebesar $x_3 \leq 100$.

Karena minimal harus ada __2 bahan baku yang dipilih__, maka alternatif solusi yang ada adalah:

1. 100 unit $x_1$ dan 100 unit $x_2$.
1. 100 unit $x_1$ dan 100 unit $x_3$.
1. 100 unit $x_2$ dan 100 unit $x_3$.
1. 100 unit $x_1$, 100 unit $x_2$ dan 100 unit $x_3$.

## Data yang Digunakan

### Data yang Dijadikan _Input_

Ada beberapa data yang dijadikan _input_ dalam permasalahan ini, yakni:

1. Data spek bahan baku, meliputi: harga (Rupiah per $kg$), _minimum order quantity_ (MOQ dalam $kg$), _leadtime_ pengiriman hingga siap guna (dalam hari), stok terkini (dalam $kg$) untuk masing-masing jenis bahan baku.
1. Data komposisi bahan baku per produk yang diproduksi.
1. Data _demand_ mingguan untuk masing-masing produk (dalam unit _batch_ produksi) termasuk kebutuhan bahan baku per _batch_.

### Contoh Data I: Spek Bahan Baku

```{r,echo=FALSE}
data.frame(bahan_baku = paste0("bb_",1:6),
           stok = round(runif(6,0,1) * 100,
                        2),
           min_order = round(runif(6,0,3) * 100,
                        1),
           leadtime = 17,
           harga = round(runif(6,120000,250000),
                        0)) %>% 
  knitr::kable(caption = "Data Bahan Baku")
```

### Contoh Data II: Komposisi Bahan Baku per Produk

```{r,echo=FALSE}
data.frame(produk = paste0("fg_",1:8),
           bb_1 = sample(c(0,1),8,replace = T),
           bb_2 = sample(c(0,1),8,replace = T),
           bb_3 = sample(c(0,1),8,replace = T),
           bb_4 = sample(c(0,1),8,replace = T),
           bb_5 = sample(c(0,1),8,replace = T),
           bb_6 = sample(c(0,1),8,replace = T)
           ) %>% 
  rowwise() %>% 
  mutate(bb_bisa_digunakan = sum(bb_1,bb_2,bb_3,bb_4,bb_5,bb_6)) %>%
  ungroup() %>% 
  knitr::kable(caption = "Contoh Sample Data Komposisi Bahan Baku")
```

### Contoh Data III: Data _Demand_ Mingguan per Produk

```{r,echo=FALSE}
data.frame(produk = paste0("fg_",1:8),
           demand_w1 = sample(c(0:10),8,replace = T),
           demand_w2 = sample(c(0:10),8,replace = T),
           demand_w3 = sample(c(0:10),8,replace = T),
           demand_w4 = sample(c(0:10),8,replace = T),
           bb_per_batch = sample(c(40,500,550,341,330,600,700,1000,640),8,replace = T)
           ) %>% 
  knitr::kable(caption = "Contoh Sample Data Demand Mingguan")
```

# PENELITIAN MANDIRI IV

## Model Optimisasi

### ___Known Parameter___ {.allowframebreaks}

Langkah pertama yang bisa dilakukan untuk membuat model optimisasi adalah menghitung dan mencari parameter-parameter terkait. Dari _update_ pada penelitian mandiri di atas, kita bisa lihat:

- $M$ sebagai himpunan semua minggu. 
    - $\hat{M} \setminus \{1,6\}$
- $P = P_1 \bigcup P_2 \bigcup P_3 \bigcup P_4 \bigcup P_5 \bigcup P_6$ sebagai himpunan produk di semua minggu.
    - $\hat{P}$ sebagai himpunan bagian dari $P$, yakni himpunan produk yang menggunakan minimal dua jenis BB.
    - $\dot{P}$ sebagai himpunan bagian dari $P$, yakni himpunan produk yang menggunakan satu jenis BB saja.
- $G = \{1,2,3,4,5,6\}$ sebagai himpunan BB.
- $D$ sebagai kebutuhan BB di bulan perencanaan, yaitu: _week_ 3 - 6.
- $maxcap$ sebagai kapasitas gudang BB.
- $\forall i \in P_j, \space g_{ijk}$ adalah kebutuhan BB (dalam ton) dari produk $i$ pada _week_ $k$.
- $\forall k \in G, \space c_k$ adalah harga BB $k$ per ton.
- $\forall k \in G, \space \epsilon_k$ adalah _minimum order quantity_ dari BB $k$.
- $\forall k \in G, \space \hat{d}_{2k}$ adalah total BB $k$ yang dibutuhkan pada _week_ 2.
- $\forall k \in G, \space Z_{ik}$ adalah stok level BB $k$ di gudang pada akhir _week_ 1.    

### _Decision Variable_ {.allowframebreaks}

Definisikan $\forall k \in G, \space x_k$ adalah banyaknya BB $k$ yang dibeli.

Berdasarkan informasi sebelumnya, kita ketahui bahwa $x_k$ bernilai bulat positif dan harus lebih besar atau sama dengan nilai $\epsilon_k$. Kemudian tidak ada kewajiban untuk membeli BB dari seluruh _supplier_. 

Maka kita bisa tuliskan: $x_k = 0$ atau $\epsilon_k \leq x_k \leq maxcap$. Untuk menghindari nilai diskontinu dari $x_k$ ini, definisikan:

$$y_k = \left\{\begin{matrix}
1, & x_k = 0 \\ 0, & \epsilon_k \leq x_k \leq maxcap
\end{matrix}\right.$$

$\forall j \in M  \setminus \{1,6\}, \forall i \in P_j, \forall k \in G$,

Definisikan: $\hat{x}_{jk}$ sebagai banyaknya pengiriman BB jenis $k$ di awal _week_ $j$.

$$a_{ijk} = \left\{\begin{matrix}
1, & \text{produk ke } i \text{ di week } j \text{ menggunakan BB } k \\ 
0, & \text{lainnya}
\end{matrix}\right.$$

Definisikan: $b_{ijk}$ sebagai proporsi penggunaan BB $k$ dari seluruh kebutuhan BB untuk produk $i$ di _week_ $j$, $\forall j \in M \setminus \{ 1 \}, \forall k \in G$.

Definisikan: $z_{jk}$ sebagai stok level BB $k$ di akhir _week_ $j$.

## _To be continued_

### _To be continued_

Saya akan _update_ dan tuliskan _constraints_ dan _objective function_ dalam waktu dekat.