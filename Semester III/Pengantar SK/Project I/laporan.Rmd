---
title: "PROJECT I"
subtitle: |
  | SK5004 
  | PENGANTAR SAINS KOMPUTASI
author: |
  | Mohammad Rizka Fadhli
  | 20921004
date: "`r format(Sys.time(),'%d %B %Y')`"
fontsize: 12pt
output:
  pdf_document:
    number_section: true
    toc: false
    fig_width: 7
    fig_height: 4
    fig_caption: true
    highlight: espresso
linestretch: 1.25
---


\newpage
\tableofcontents
\newpage
\listoftables
\newpage
\listoffigures
\newpage


```{r,include=FALSE}
rm(list=ls())

library(dplyr)
library(ggplot2)

# setwd("/mnt/chromeos/removable/Workstation/209_ITB/Semester III/Pengantar SK/Project I")
setwd("/cloud/project/Semester III/Pengantar SK/Project I")
```

# Pendahuluan

Sains komputasi adalah disiplin ilmu yang mempelajari penyelesaian berbagai masalah dalam sains melalui pendekatan komputasi. Salah satunya adalah mencari solusi dari persamaan diferensial yang merupakan fungsi kontinu menggunakan pendekatan yang bersifat diskrit. Sebagai pembahasan pada laporan ini, diberikan satu masalah persamaan diferensial berupa _unconstrained growth and decay_ dari suatu permasalahan peluruhan dan pembentukan beberapa zat radioaktif lalu kemudian akan diselesaikan menggunakan metode pendekatan diskrit.

## Masalah

Laju peluruhan suatu zat radioaktif bisa dituliskan dalam persamaan diferensial berikut ini:

$$\frac{dQ}{dt} = -r Q(t)$$

Untuk suatu $r$ bernilai positif (_decay rate_) dan $Q(t)$ adalah fungsi massa zat radioaktif terhadap waktu ($t$). Suatu zat radioaktif bisa luruh membentuk zat radioaktif lainnya membuat rantai reaksi.

Buatlah model rantai reaksi radioaktif yang berisi 3 elemen: dari zat A luruh menjadi zat B dan luruh menjadi zat C!

## Bahasa Pemrograman

Saya menggunakan bahasa pemrograman **R** versi `4.0.4` untuk membuat program dan melakukan simulasi untuk menyelesaikan permasalahan di atas. 

\newpage

# Dasar Teori

## _Unconstrained Growth and Decay_

Model _unconstrained growth and decay_ pada dasarnya merupakan model pertumbuhan atau peluruhan yang laju perubahannya proporsional dengan populasi (kondisi) saat ini. Populasi akan bertumbuh atau berkurang tanpa ada batasan atau hal yang menghalangi perubahannya. Pada masalah yang dihadapi, suatu zat radioaktif akan meluruh mengikuti persamaan diferensial berikut:

$$\frac{dQ}{dt} = -r Q(t)$$

dan akan bertumbuh juga mengikuti persamaan diferensial berikut:

$$\frac{dQ}{dt} = r Q(t)$$

Perbedaannya adalah pada nilai $r$ yang kelak akan digunakan untuk masing-masing zat radioaktif $A$, $B$, dan $C$.

Solusi analitik dari peluruhan adalah: $P = P_0 e^{-rt}$

```{r,echo=FALSE,fig.cap = "Ilustrasi Peluruhan",fig.height=3.5}
rm(list=ls())

r = 0.55
f = function(t){
  P0 * exp(-r * t)
}

t = seq(0,15,by = .05)
P0 = 10
P = f(t)

data.frame(t,P) %>% 
  ggplot(aes(x = t,
             y = P)) +
  geom_line(color = "steelblue") +
  labs(title = "Ilustrasi Peluruhan Tak Terbatas",
       subtitle = "P0 = 10 dan r = -0.55",
       caption = "20921004\nMohammad Rizka Fadhli",
       y = "Populasi - P(t)",
       x = "Waktu - t")
```

\newpage

sedangkan solusi analitik dari pertumbuhan adalah: $P = P_0 e^{rt}$

```{r,echo=FALSE,fig.cap = "Ilustrasi Pertumbuhan",fig.height=3.5}
rm(list=ls())

r = 0.55
f = function(t){
  P0 * exp(r * t)
}

t = seq(0,15,by = .05)
P0 = 10
P = f(t)

data.frame(t,P) %>% 
  ggplot(aes(x = t,
             y = P)) +
  geom_line(color = "steelblue") +
  labs(title = "Ilustrasi Pertumbuhan Tak Terbatas",
       subtitle = "P0 = 10 dan r = 0.55",
       caption = "20921004\nMohammad Rizka Fadhli",
       y = "Populasi - P(t)",
       x = "Waktu - t")
```

## _Finite Difference Equation_

Pendekatan diskrit untuk menyelesaikan persamaan diferensial menggunakan komputer adalah dengan membuat persamaan kontinu di atas menjadi bentuk persamaan beda. Komputer tidak bisa menyelesaikan masalah pada $t$ kontinu, oleh karena itu dibutuhkan pendekatan diskrit berupa laju perubahan pada $\Delta t$ yang relatif kecil. Bentuk umum persamaan beda adalah sebagai berikut:

$$
\text{new value} = \text{old values} + \text{change in value}
$$

Berdasarkan bentuk di atas, saya akan membuat dua algoritma untuk menyelesaikannya, yakni:

## Algoritma Euler

Algoritma Euler untuk menyelesaikan persamaan diferensial adalah sebagai berikut:

```
initialize
  sim_length
  population
  rate
  dt
compute:
  rate_per_step = rate * dt
  num_iter = sim_length / dt
for i: 1 to num_iter do
  population = population + rate_per_step * population
  t = i * dt
  print(t, population)
```

## Algoritma Runge Kutta $4^{th}$

Bentuk umum dari metode Runge Kutta orde 4 adalah sebagai berikut:

$$y_{n+1} = y_n + h \sum_{i=1}^n b_i k_i$$

dimana:

1. $y(t=0)$ diketahui.
1. $k_i$ adalah konstanta yang harus dicari, yakni:

$$\begin{matrix}
k_1 = f(t_n,y_n) \\
k_2 = f(t_n + \frac{h}{2}, y_n + h \frac{k_1}{2}) \\
k_3 = f(t_n + \frac{h}{2}, y_n + h \frac{k_2}{2}) \\ 
k_4 = f(t_n + h, y_n + h k_3) \\
\end{matrix}$$

\newpage

Berikut adalah algoritmanya:


```
initialize
  f # fungsi persamaan diferensial
  x0
  y0
  h
  sim_length
  rate
  dt

compute:
  num_iter = sim_length / dt
  
for i: 1 to num_iter do
  compute:
    k1 = f(x0,y0)
    k2 = f(x0 + 0.5*h,y0 + 0.5*k1*h)
    k3 = f(x0 + 0.5*h,y0 + 0.5*k2*h)
    k4 = f(x0 + h,y0 + k3*h)
    y0 = y0 + (1/6)*(k1 + 2*k2 + 2*k3 + k4) * h
    x0 = x0 + h
    print(x0,y0)
```

\newpage

# Model Matematika

Untuk membuat model matematika dari permasalahan ini, saya akan membuat diagram dari model sehingga hubungan antara ketiga zat radioaktif tersebut bisa terlihat dengan jelas.

## Diagram Model

Berikut ini adalah diagram model:

```{r out.width = "80%",echo=FALSE,fig.retina = 10,fig.cap = "Diagram Model",fig.align='center'}
knitr::include_graphics("Project I.png")
```

Zat A akan luruh dengan laju sebesar $r_A$ membentuk zat B dengan laju pertumbuhan sebesar $r_A$ juga. Kemudian zat B akan luruh dengan laju sebesar $r_B$ membentuk zat C dengan laju pertumbuhan sebesar $r_B$ juga. Kemudian zat C akan luruh dengan lajur sebesar $r_C$.

## Persamaan Diferensial

Berdasarkan diagram dan keterangan di atas, kita dapatkan bahwa:

1. Perubahan massa zat A hanya bergantung pada peluruhan saja.
1. Perubahan massa zat B bergantung pada pembentukan dan peluruhan.
1. Perubahan massa zat C bergantung pada pembentukan dan peluruhan.

Dari sini, maka didapatkan sistem persamaan diferensial sebagai berikut:

Model perubahan massa zat A:

$$\frac{dA}{dt} = -r_A A$$

\newpage

Model perubahan massa zat B:

$$\frac{dB}{dt} = r_A A - r_B B$$

Model perubahan massa zat C:

$$\frac{dC}{dt} = r_B B - r_C C$$

## Algoritma Penyelesaian

Berikut adalah algoritma penyelesaian dengan cara mengubah persamaan diferensial menjadi persamaan beda hingga:

```
# definisi dan initial condition
r_a   # rate peluruhan A dan pertumbuhan B
r_b   # rate peluruhan B dan pertumbuhan C
r_c   # rate peluruhan C

q_a   # massa awal zat radioaktif A
q_b   # massa awal zat radioaktif B
q_c   # massa awal zat radioaktif C
t     # waktu awal t = 0

dt           # delta t
iter_length  # panjang iterasi
num_iter = iter_length / dt  # berapa banyak iterasi 

# proses iterasi
for i in 1 to num_iter do
    # peluruhan A dan pertumbuhan B
    rate_1 = r_a * q_a[i-1] * dt

    # peluruhan B dan pertumbuhan C
    rate_2 = r_b * q_b[i-1] * dt

    # peluruhan C
    rate_3 = r_c * q_c[i-1] * dt
    
    # perhitungan massa zat A
    q_a[i] = q_a[i-1] - rate_1
    # perhitungan massa zat B
    q_b[i] = q_b[i-1] + rate_1 - rate_2
    # perhitungan massa zat C
    q_c[i] = q_c[i-1] + rate_2 - rate_3
    # perhitungan massa waktu
    t[i] = t[i-1] + dt

print(t,q_a,q_b,q_c)

```

Algoritma di atas merupakan penerapan metode Euler untuk menyelesaikan sistem persamaan diferensial.

## Program Model Matematika

Pada bagian ini, saya akan membuat dua program untuk menyelesaikan permasalahan ini, yakni:

### Program dengan Metode Euler

```
# INPUT dari user:
  # rate peluruhan A dan pertumbuhan B
  r_a = readline(prompt = "Rate peluruhan A: ") %>% as.numeric()
  # rate peluruhan B dan pertumbuhan C
  r_b = readline(prompt = "Rate peluruhan B: ") %>% as.numeric()
  # rate peluruhan C
  r_c = readline(prompt = "Rate peluruhan C: ") %>% as.numeric()
  # massa awal zat radioaktif A
  qa0 = readline(prompt = "massa awal zat radioaktif A: ") %>% as.numeric()
  # massa awal zat radioaktif B
  qb0 = readline(prompt = "massa awal zat radioaktif B: ") %>% as.numeric()
  # massa awal zat radioaktif C
  qc0 = readline(prompt = "massa awal zat radioaktif C: ") %>% as.numeric()
  # delta t
  dt0 = readline(prompt = "nilai delta t: ") %>% as.numeric()
  # panjang iterasi
  iter_length = readline(prompt = "seberapa panjang iterasi dilakukan: ") %>% 
                as.numeric()


# proses perhitungan dengan metode Euler
q_a = c(qa0)  # array massa zat radioaktif A
q_b = c(qb0)  # array massa zat radioaktif B
q_c = c(qc0)  # array massa zat radioaktif C
t = c(0)      # waktu awal t = 0
dt = dt0
num_iter = (iter_length / dt) + 1

# proses iterasi
for(i in 2:num_iter){
    # peluruhan A dan pertumbuhan B
    rate_1 = r_a * q_a[i-1] * dt
    # peluruhan B dan pertumbuhan C
    rate_2 = r_b * q_b[i-1] * dt
    # peluruhan C
    rate_3 = r_c * q_c[i-1] * dt
    
    # perhitungan massa zat A
    q_a[i] = q_a[i-1] - rate_1
    # perhitungan massa zat B
    q_b[i] = q_b[i-1] + rate_1 - rate_2
    # perhitungan massa zat C
    q_c[i] = q_c[i-1] + rate_2 - rate_3
    # perhitungan massa waktu
    t[i] = t[i-1] + dt
}

# membuat data output
df = data.frame(t,q_a,q_b,q_c)
# print output pada layar
print(df)
```

Berikut adalah _screenshoot_ saat program dijalankan dengan parameter sebagai berikut:

```{r,echo=FALSE}
data.frame(Parameter = c("r_a","r_b","r_c","qa0","qb0","qc0","dt0","iter_length"),
           Value = c(.5,.4,.3,10,0,0,.25,5)) %>% knitr::kable(caption = "Parameter Simulasi Program Euler")
```

```{r out.height="45%",echo=FALSE,fig.cap = "Hasil Simulasi Program Euler",fig.align='center'}
knitr::include_graphics("skrinsut_1.png")
```

\newpage

Program tersebut saya simpan dengan nama __Program Euler.R__ dan saya lampirkan bersamaan dengan laporan ini. Untuk menggunakannya, silakan buka __R__ dan ketikkan perintah `source("Program Euler.R")`. 


### Program dengan Metode Runge Kutta $4^{th}$

Berikut adalah program yang saya buat menggunakan metode Runge Kutta $4^{th}$:

```
# INPUT dari user:
  # rate peluruhan A dan pertumbuhan B
  r_a = readline(prompt = "Rate peluruhan A: ") %>% as.numeric()
  # rate peluruhan B dan pertumbuhan C
  r_b = readline(prompt = "Rate peluruhan B: ") %>% as.numeric()
  # rate peluruhan C
  r_c = readline(prompt = "Rate peluruhan C: ") %>% as.numeric()
  # massa awal zat radioaktif A
  q_a = readline(prompt = "massa awal zat radioaktif A: ") %>% as.numeric()
  # massa awal zat radioaktif B
  q_b = readline(prompt = "massa awal zat radioaktif B: ") %>% as.numeric()
  # massa awal zat radioaktif C
  q_c = readline(prompt = "massa awal zat radioaktif C: ") %>% as.numeric()
  # panjang iterasi
  iter_length = readline(prompt = "seberapa panjang iterasi dilakukan: ") %>% 
                as.numeric()
  # h
  h = readline(prompt = "selang h: ") %>% as.numeric()
  
# initial condition
t   = 0   # waktu awal t = 0

# kalkulasi banyak iterasi yang dilakukan
num_iter = (iter_length / h) + 1

# definisi fungsi persamaan diferensial
  # zat radio aktif A
  d_a = function(t,q_a){
    (-r_a * q_a) 
  }
  # zat radio aktif B
  d_b = function(t,q_a,q_b){
    ((r_a * q_a) - (r_b * q_b)) 
  }
  # zat radio aktif C
  d_c = function(t,q_b,q_c){
    ((r_b * q_b) - (r_c * q_c)) 
  }

# persiapan array utk iterasi
A = c(q_a)
B = c(q_b)
C = c(q_c)
t_ = c(t)


# proses iterasi
for(i in 2:num_iter){
  # kita akan hitung dulu zat a
  k1 = d_a(t,A[i-1]) 
  k2 = d_a(t + 0.5*h,A[i-1] + 0.5*k1*h) 
  k3 = d_a(t + 0.5*h,A[i-1] + 0.5*k2*h) 
  k4 = d_a(t + h,A[i-1] + k3*h) 
  
  A[i] = A[i-1] + (1/6)*(k1 + 2*k2 + 2*k3 + k4) * h
  
  # kita hitung zat b
  k1 = d_b(t,
           A[i-1],
           B[i-1]) 
  k2 = d_b(t + 0.5*h,
           A[i-1] + 0.5*k1*h,
           B[i-1] + 0.5*k1*h) 
  k3 = d_b(t + 0.5*h,
           A[i-1] + 0.5*k2*h,
           B[i-1] + 0.5*k2*h) 
  k4 = d_b(t + h,
           A[i-1] + k3*h,
           B[i-1] + k3*h) 
  
  B[i] = B[i-1] + (1/6)*(k1 + 2*k2 + 2*k3 + k4) * h
  
  # kita hitung zat c
  k1 = d_c(t,
           B[i-1],
           C[i-1]) 
  k2 = d_c(t + 0.5*h,
           B[i-1] + 0.5*k1*h,
           C[i-1] + 0.5*k1*h) 
  k3 = d_c(t + 0.5*h,
           B[i-1] + 0.5*k2*h,
           C[i-1] + 0.5*k2*h) 
  k4 = d_c(t + h,
           B[i-1] + k3*h,
           C[i-1] + k3*h) 
  
  C[i] = C[i-1] + (1/6)*(k1 + 2*k2 + 2*k3 + k4) * h
  
  t_[i] = t_[i-1] + h
  
}

# output
output = data.frame(t_,A,B,C)

# mengeluarkan output ke layar
print(output)

```

Program tersebut saya simpan dengan nama __Program RK 4.R__ dan saya lampirkan bersamaan dengan laporan ini. Untuk menggunakannya, silakan buka __R__ dan ketikkan perintah `source("Program RK 4.R")`. 


\newpage

# Diskusi

Sekarang saya akan _run_ program Euler menggunakan parameter yang ada di soal.

## Menggunakan Program Euler

### Simulasi

Berikut adalah parameter di soal:

```{r,echo=FALSE}
data.frame(Parameter = c("r_a","r_b","r_c","qa0","qb0","qc0","dt0","iter_length"),
           Value = c(.0137,.051,0,4*10^(-8),0,0,.5,10)) %>% 
           knitr::kable(caption = "Parameter di Soal")
```

Massa zat A adalah $S \times 10^{-8}$ dengan $S$ adalah 2 digit terakhir NIM saya (20921004). Sehingga $S = 4$. _Rate_ peluruhan untuk zat C saya buat sama dengan nol (karena tidak dinyatakan dalam soal).

```{r,echo=FALSE}
rm(list=ls())

# definisi dan initial condition
r_a = .0137  # rate peluruhan A dan pertumbuhan B
r_b = .051  # rate peluruhan B dan pertumbuhan C
r_c = .0  # rate peluruhan C

q_a = c(4*10^(-8)) # massa awal zat radioaktif A
q_b = c(0)  # massa awal zat radioaktif B
q_c = c(0)  # massa awal zat radioaktif C
t = c(0)    # waktu awal t = 0

dt = c(.5)
iter_length = 10
num_iter = iter_length / dt[1]

for(i in 2:(num_iter + 1)){
    # peluruhan A dan pertumbuhan B
    rate_1 = r_a * q_a[i-1] * dt
    # peluruhan B dan pertumbuhan C
    rate_2 = r_b * q_b[i-1] * dt
    # peluruhan C
    rate_3 = r_c * q_c[i-1] * dt
    
    q_a[i] = q_a[i-1] - rate_1
    q_b[i] = q_b[i-1] + rate_1 - rate_2
    q_c[i] = q_c[i-1] + rate_2 - rate_3
    t[i] = t[i-1] + dt
}

df = data.frame(t,q_a,q_b,q_c)

df 
```

### Grafik Hasil Simulasi

Berikut ini adalah grafiknya jika saya perpanjang nilai $t$-nya menjadi 300 dan $dt = 0.05$ :

```{r,echo=FALSE,fig.cap = "Ilustrasi Hasil Simulasi Menggunakan Parameter Soal"}
rm(list=ls())

# definisi dan initial condition
r_a = .0137  # rate peluruhan A dan pertumbuhan B
r_b = .051  # rate peluruhan B dan pertumbuhan C
r_c = .0  # rate peluruhan C

q_a = c(4*10^(-8)) # massa awal zat radioaktif A
q_b = c(0)  # massa awal zat radioaktif B
q_c = c(0)  # massa awal zat radioaktif C
t = c(0)    # waktu awal t = 0

dt = .05
iter_length = 300
num_iter = iter_length / dt

for(i in 2:(num_iter + 1)){
    # peluruhan A dan pertumbuhan B
    rate_1 = r_a * q_a[i-1] * dt
    # peluruhan B dan pertumbuhan C
    rate_2 = r_b * q_b[i-1] * dt
    # peluruhan C
    rate_3 = r_c * q_c[i-1] * dt
    
    q_a[i] = q_a[i-1] - rate_1
    q_b[i] = q_b[i-1] + rate_1 - rate_2
    q_c[i] = q_c[i-1] + rate_2 - rate_3
    t[i] = t[i-1] + dt
}

df = data.frame(t,q_a,q_b,q_c)


df %>% 
  reshape2::melt(id.vars = "t") %>% 
  ggplot(aes(x = t,y = value,color = variable)) +
  geom_line() +
  scale_color_manual(values = c("darkred","steelblue","darkgreen")) +
  labs(title = "Hasil Simulasi dengan Parameter dari Soal",
       subtitle = "Menggunakan Program Euler",
       y = "Massa zat",
       color = "Jenis Zat Radioaktif")
```

Terlihat bahwa zat A luruh sepenuhnya membentuk zat B yang kemudian luruh sepenuhnya sehingga hanya menyisakan zat C yang terus bertumbuh hingga massanya sebesar $Q_A(t = 0)$.

## Menggunakan Program Runge Kutta $4^{th}$

### Simulasi


### Grafik Hasil Simulasi

\newpage

# Kesimpulan

