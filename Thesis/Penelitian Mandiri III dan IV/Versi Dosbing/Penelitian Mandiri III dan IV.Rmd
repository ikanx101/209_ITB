---
title: "Penelitian Mandiri Sains Komputasi III dan IV"
subtitle: _Update Progress_
author: | 
    | Mohammad Rizka Fadhli 
    | Magister Sains Komputasi, FMIPA, ITB
    | 20921004@mahasiswa.itb.ac.id
date: "`r format(Sys.time(), '%d %B %Y')`"
fontsize: 12pt
output: 
  pdf_document:
    number_sections: false
    toc: false
    fig_width: 7
    fig_height: 4
    fig_caption: true
    highlight: breezedark
bibliography: references.bib
linestretch: 1.5
colorlinks: true
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyfoot[CO,CE]{20921004@mahasiswa.itb.ac.id}
- \fancyfoot[LE,RO]{hal \thepage}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(dplyr)
```

\newpage
\tableofcontents
\newpage
\listoffigures
\newpage
\listoftables

\newpage

# RENCANA KERJA

## Rencana Judul Thesis

_Optimization Model for Supplier Selection and Raw-Material Composition: Case Study FnB Manufacture_

## Target Luaran

### Penelitian Mandiri III

_Data collection_ dan dokumentasi _production system_.

### Penelitian Mandiri IV

Model optimisasi yang telah disempurnakan.

\newpage

# PENELITIAN MANDIRI III

# DOKUMENTASI SISTEM PRODUKSI

## Masalah Optimisasi

Penentuan keputusan strategis dalam hal:

- Memilih _supplier_ bahan mentah.
- Menentukan banyaknya bahan mentah yang harus dibeli dari suatu _supplier_.
- Menentukan komposisi bahan mentah di setiap produk.

dengan tujuan total biaya pembelian seminim mungkin tetapi memenuhi kebutuhan yang ada.

## Kondisi yang Ada Saat Ini

Saat ini pemilihan _supplier_ dan penentuan kuantitas pembelian _raw material_ dilakukan secara manual dengan mempertimbangkan data-data terkait secara mingguan oleh departemen PPIC (_Production Planning and Inventory Control_). Data-data yang terkait tersebut adalah data _demand product_ dan data komposisi _raw material_ per produk. 

Jika ada perubahan _demand_, maka proses perhitungan tersebut harus dihitung ulang kembali. Proses perhitungan ini memerlukan waktu yang cukup lama karena banyaknya produk yang terlibat.

## Rencana Kerja 

Permasalahan dalam penentuan _supplier_ dan _raw material_ ini bisa dipandang sebagai masalah optimisasi dan dapat dibuat menjadi suatu model optimisasi. Model optimisasi ini kelak akan diimplementasikan pada departemen PPIC sehingga proses pemilihan _supplier_ dan penentuan kuantitas pembelian _raw material_ bisa dilakukan secara cepat dan tepat. Diharapkan proses bisnis menjadi menjadi lebih efisien dan _cost_ yang ada bisa ditekan lebih baik lagi.

Selain itu, akan dibuat suatu _software decision support system_ berdasarkan model optimisasi ini untuk memudahkan dalam hal penentuan penyediaan _raw material_. 

## Dokumentasi Sistem Produksi

### Rangkaian Produksi

Dalam rangkaian produksi, __NFI__ menggunakan banyak sekali bahan baku tapi ada beberapa bahan baku utama yang paling sering digunakan di berbagai produknya. Selama ini __NFI__ memesan bahan-bahan baku tersebut secara langsung setiap bulannya dengan besarnya pemesanan disesuaikan dengan:

1. Angka _demand_ atau _forecast_ masing-masing produk yang menggunakan bahan-bahan baku tersebut.
1. _Existing stock_ bahan baku yang ada di gudang bahan baku.
1. _Minimum order_ per jenis bahan baku yang ditetapkan _supplier_.

### Informasi Terkait Pengiriman Bahan Baku 

Pengiriman bahan baku oleh para _supplier_ dilakukan sebanyak 4 kali dalam sebulan dengan jumlah sesuai dengan aturan berikut:

- Banyaknya bahan baku pada __pengiriman pertama__ disesuaikan dengan __stok__ ___existing___ dan ___demand___ produk terkait bahan baku tersebut pada minggu I.
- Sedangkan bahan baku gula pada __pengiriman kedua hingga keempat__ dibuat proporsional.
- __Waktu pengiriman dan inspeksi__ adalah selama 17 hari setelah pemesanan gula sampai akhirnya gula tersebut dapat digunakan untuk produksi. 

Oleh karena itu, perencanaan pembelian gula dilakukan setidaknya sebulan sebelum gula tersebut akan digunakan.

### Ilustrasi Pengiriman Bahan Baku

Contoh pada suatu bulan tertentu:

- Kebutuhan bahan baku diperkirakan sebesar __400 ton__.
- Stok _existing_ bahan baku di gudang bahan baku ada __50 ton__.
- Maka __NFI__ perlu memesan bahan baku sebesar __350 ton__.
- Pengiriman dilakukan __4 kali__.
    - Pada minggu I, diperkirakan kebutuhan bahan baku ada sebesar __100 ton__. Oleh karena itu, __pengiriman pertama__ adalah sebesar __50 ton__ saja.
    - Pada minggu II, III, dan IV pengiriman gula adalah proporsional sebesar __100 ton__.


Oleh karena itu, kelak pada model matematika perlu ada _constraints_ terkait hal ini.

### Ilustrasi Pengiriman Bahan Baku

```{r out.width="90%",echo=FALSE,fig.cap="Simplifikasi dari Penggunaan Bahan Baku",fig.align='center'}
knitr::include_graphics("ilustrasi.png")
```

### Informasi Terkait Jenis Bahan Baku 

Saat ini, ada __6__ jenis bahan baku yang bisa dipesan ke __6__ _supplier_ yang berbeda. Masing-masing bahan baku digunakan untuk membuat produk tertentu. Informasi lain yang perlu diketahui adalah:

- __Tidak ada kewajiban__ bagi NFI untuk membeli semua jenis bahan baku tersebut. 
- Terkait penggunaan bahan baku:
    - Sebagian kecil dari produk hanya bisa diproduksi dengan __satu jenis bahan baku saja__.
    - Sebagian besar lainnya memungkinkan untuk diproduksi dengan __dua atau lebih jenis bahan baku__.
        - Unit per jenis bahan baku yang digunakan untuk membuat produk adalah sama walau berbeda jenis bahan baku.
- Setidaknya minimal ada __2 jenis bahan baku__ yang dibeli NFI sebagai _back up_ substitusi bahan baku.
- Pembelian bahan baku harus memenuhi _minimum order_ yang ditetapkan oleh _supplier_ __tapi__ jika pembelian di atas _minimum order_ harus dilakukan __pembulatan__. Misalkan:
    - _Minimum order_ adalah __10 ton__, maka:
        - Boleh membeli __11 ton__.
        - Tidak boleh membeli __10.5 ton__.
- Harga masing-masing jenis bahan baku berbeda. Namun untuk lama pengiriman, pada kasus ini semua gula memiliki lama pengiriman yang sama.

### Ilustrasi Alur Pengadaan Bahan Baku: Misal - Gula

Berikut adalah _summary_ alur pengadaan bahan baku gula yang dilakukan Nutrifood:

```{r out.width="90%",echo=FALSE,fig.cap="Simplifikasi dari Penggunaan Bahan Baku",fig.align='center'}
knitr::include_graphics("ilustrasi_2.png")
```

### Informasi Terkait Substitusi Bahan Baku

#### Case I: Minimal __2 jenis__ bahan baku sebagai _back up_

Dalam suatu bulan tertentu, untuk memproduksi produk __A__, __B__, dan __C__ dibutuhkan bahan baku $x_1$, $x_2$, __atau__ $x_3$.

Untuk memastikan tidak ada masalah di kemudian hari (sebagai _back up_), maka minimal harus ada __2__ jenis bahan baku yang harus dibeli. Alternatifnya:

1. Membeli $x_1$ dan $x_2$,
1. Membeli $x_1$ dan $x_3$,
1. Membeli $x_2$ dan $x_3$, atau
1. Membeli $x_1$, $x_2$, dan $x_3$.

### Informasi Terkait Substitusi Bahan Baku 

#### Case II: Unit bahan baku yang digunakan __sama__

Dalam suatu bulan tertentu, untuk membuat produk __A__, kita bisa menggunakan:

1. 100 unit $x_1$ atau,
1. 100 unit $x_2$.

Sedangkan untuk membuat produk __B__, kita bisa menggunakan:

1. 100 unit $x_2$ atau,
1. 100 unit $x_3$.

### Informasi Terkait Substitusi Bahan Baku 

#### Case II: Unit bahan baku yang digunakan __sama__

Dari kasus di atas, kita bisa menuliskan bahwa:

1. Kebutuhan bahan baku 1 ada sebesar $x_1 \leq 100$.
1. Kebutuhan bahan baku 2 ada sebesar $x_2 \leq 200$.
1. Kebutuhan bahan baku 3 ada sebesar $x_3 \leq 100$.

Karena minimal harus ada __2 bahan baku yang dipilih__, maka alternatif solusi yang ada adalah:

1. 100 unit $x_1$ dan 100 unit $x_2$.
1. 100 unit $x_1$ dan 100 unit $x_3$.
1. 100 unit $x_2$ dan 100 unit $x_3$.
1. 100 unit $x_1$, 100 unit $x_2$ dan 100 unit $x_3$.

## Data yang Digunakan

### Data yang Dijadikan _Input_

Ada beberapa data yang dijadikan _input_ dalam permasalahan ini, yakni:

1. Data spek bahan baku, meliputi: harga (Rupiah per $kg$), _minimum order quantity_ (MOQ dalam $kg$), _leadtime_ pengiriman hingga siap guna (dalam hari), stok terkini (dalam $kg$) untuk masing-masing jenis bahan baku.
1. Data komposisi bahan baku per produk yang diproduksi.
1. Data _demand_ mingguan untuk masing-masing produk (dalam unit _batch_ produksi) termasuk kebutuhan bahan baku per _batch_.

### Contoh Data I: Spek Bahan Baku

```{r,echo=FALSE}
data.frame(bahan_baku = paste0("bb_",1:6),
           stok = round(runif(6,0,1) * 100,
                        2),
           min_order = round(runif(6,0,3) * 100,
                        1),
           leadtime = 17,
           harga = round(runif(6,120000,250000),
                        0)) %>% 
  knitr::kable(caption = "Data Bahan Baku")
```

### Contoh Data II: Komposisi Bahan Baku per Produk

```{r,echo=FALSE}
data.frame(produk = paste0("fg_",1:8),
           bb_1 = sample(c(0,1),8,replace = T),
           bb_2 = sample(c(0,1),8,replace = T),
           bb_3 = sample(c(0,1),8,replace = T),
           bb_4 = sample(c(0,1),8,replace = T),
           bb_5 = sample(c(0,1),8,replace = T),
           bb_6 = sample(c(0,1),8,replace = T)
           ) %>% 
  rowwise() %>% 
  mutate(bb_bisa_digunakan = sum(bb_1,bb_2,bb_3,bb_4,bb_5,bb_6)) %>%
  ungroup() %>% 
  knitr::kable(caption = "Contoh Sample Data Komposisi Bahan Baku")
```

### Contoh Data III: Data _Demand_ Mingguan per Produk

```{r,echo=FALSE}
data.frame(produk = paste0("fg_",1:8),
           demand_w1 = sample(c(0:10),8,replace = T),
           demand_w2 = sample(c(0:10),8,replace = T),
           demand_w3 = sample(c(0:10),8,replace = T),
           demand_w4 = sample(c(0:10),8,replace = T),
           bb_per_batch = sample(c(40,500,550,341,330,600,700,1000,640),8,replace = T)
           ) %>% 
  knitr::kable(caption = "Contoh Sample Data Demand Mingguan")
```


\newpage

# PENELITIAN MANDIRI IV 

# MODEL OPTIMISASI 

Masalah _supplier selection_ and _raw material composition_ yang dipertimbangkan adalah masalah dengan satu kriteria, yaitu total harga pengadaan tetapi ukuran masalahnya lebih besar karena penentuan _supplier_ mana yang akan dipilih dan berapa _quantity_ yang akan dipesan hanya sebagian dari variabel keputusan. Variabel keputusan lainnya adalah bagaimana distribusi pengiriman dari tiap _supplier_ dan komposisi dari tiap varian bubuk minuman.  Karena itu, masalah krusial pertama dari penyelesaian masalah ini adalah menurunkan masalah optimisasi yang tepat yang dapat menjadi model dari masalah ini.

Berdasarkan informasi-informasi yang telah didapatkan dari `Penelitian Mandiri III`, berikut adalah model optimisasi dari permasalahan _supplier selection_ dan _raw material composition_.

## Parameter yang Diketahui

Notasikan:

- $M$ sebagai himpunan semua minggu. 
    - $\hat{M} \setminus \{1,6\}$
- $P = P_1 \bigcup P_2 \bigcup P_3 \bigcup P_4 \bigcup P_5 \bigcup P_6$ sebagai himpunan produk di semua minggu.
    - $\hat{P}$ sebagai himpunan bagian dari $P$, yakni himpunan produk yang menggunakan minimal dua jenis BB.
    - $\dot{P}$ sebagai himpunan bagian dari $P$, yakni himpunan produk yang menggunakan satu jenis BB saja.
- $G = \{1,2,3,4,5,6\}$ sebagai himpunan BB.
- $D$ sebagai kebutuhan BB di bulan perencanaan, yaitu: _week_ 3 - 6.
- $maxcap$ sebagai kapasitas gudang BB.
- $\forall i \in P_j, \space g_{ijk}$ adalah kebutuhan BB (dalam ton) dari produk $i$ pada _week_ $k$.
- $\forall k \in G, \space c_k$ adalah harga BB $k$ per ton.
- $\forall k \in G, \space \epsilon_k$ adalah _minimum order quantity_ dari BB $k$.
- $\forall k \in G, \space \hat{d}_{2k}$ adalah total BB $k$ yang dibutuhkan pada _week_ 2.
- $\forall k \in G, \space Z_{ik}$ adalah stok level BB $k$ di gudang pada akhir _week_ 1.    

## Variabel Keputusan

### Variabel I {.unnumbered .unlisted}

Definisikan $\forall k \in G, \space x_k$ adalah banyaknya BB $k$ yang dibeli.

Berdasarkan informasi sebelumnya, kita ketahui bahwa $x_k$ bernilai bulat positif dan harus lebih besar atau sama dengan nilai $\epsilon_k$. Kemudian tidak ada kewajiban untuk membeli BB dari seluruh _supplier_. 

Maka kita bisa tuliskan: $x_k = 0$ atau $\epsilon_k \leq x_k \leq maxcap$. Untuk menghindari nilai diskontinu dari $x_k$ ini, definisikan:

$$y_k = \left\{\begin{matrix}
1, & x_k = 0 \\ 0, & \epsilon_k \leq x_k \leq maxcap
\end{matrix}\right.$$

$\forall j \in M  \setminus \{1,6\}, \forall i \in P_j, \forall k \in G$,

### Variabel II {.unnumbered .unlisted}

Definisikan: $\hat{x}_{jk}$ sebagai banyaknya pengiriman BB jenis $k$ di awal _week_ $j$.

$$a_{ijk} = \left\{\begin{matrix}
1, & \text{produk ke } i \text{ di week } j \text{ menggunakan BB } k \\ 
0, & \text{lainnya}
\end{matrix}\right.$$

### Variabel III {.unnumbered .unlisted}

Definisikan: $b_{ijk}$ sebagai proporsi penggunaan BB $k$ dari seluruh kebutuhan BB untuk produk $i$ di _week_ $j$, $\forall j \in M \setminus \{ 1 \}, \forall k \in G$.

### Variabel IV {.unnumbered .unlisted}

Definisikan: $z_{jk}$ sebagai stok level BB $k$ di akhir _week_ $j$.

## Kendala Optimisasi

### Kendala I {.unnumbered .unlisted}

Kendala I adalah penghubung yang benar antara variabel keputusan biner, integer, atau kontinu yang berkaitan:

$$\begin{matrix}
\forall k \in G, &  \\
 & x_k \leq Dy_k \\
 & x_k \geq \epsilon y_k \\
\forall j \in M \setminus \{ 1,2 \}, \forall i \in P_j, \forall k \in G, & \\
 & b_{ijk} \leq a_{ijk} \\
 & b_{ijk} \geq \mu a_{ijk}
\end{matrix}$$

untuk suatu nilai $\mu$ yang kecil.

### Kendala II {.unnumbered .unlisted}

Kendala II dibuat agar total BB yang dipesan tidak kurang dari total _demand_ di bulan perencanaan.

$$\sum_{k \in G} x_k \geq D$$

### Kendala III {.unnumbered .unlisted}

Kendala III mengatur hubungan antara total pembelian BB dan pengiriman setiap minggu.

$$\begin{matrix}
\forall k \in G, & \\
 & x_k = \sum_{j \in \hat{M}} \hat{x}_{jk}
\end{matrix}$$

\newpage

### Kendala IV {.unnumbered .unlisted}

Kendala IV menjaga volume pengiriman gula pada _week_ 2, 3, dan 4 selalu sama.

$$\begin{matrix}
\forall k \in G, & \\
 & \hat{x}_{3k} = \hat{x}_{4k} \\
 & \hat{x}_{4k} = \hat{x}_{5k} 
\end{matrix}$$

### Kendala V {.unnumbered .unlisted}

Kendala V berfungsi untuk menjaga komposisi gula yang diinginkan.

$$\begin{matrix}
\forall j \in M \setminus \{ 1,2 \}, \space \forall i \in \hat{P}_j, & \\
 & \sum_{k \in G} a_{ijk} \geq 2 \\
 & \sum_{k \in G} b_{ijk} = 1 \\
\forall j \in M \setminus \{ 1,2 \}, \space \forall i \in \dot{P}_j, & \\ 
 & \sum_{k \in G} a_{ijk} = 1 \\
 & \sum_{k \in G} b_{ijk} = 1
\end{matrix}$$

### Kendala VI {.unnumbered .unlisted}

Kendala VI berfungsi untuk menjaga stok level sesaat setelah pengiriman BB agar tidak melebihi kapasitas gudang.

$$\begin{matrix}
 & \sum_{k \in G} (Z_{1k} + \hat{x}_{1k} - \hat{d}_{2k} + z_{jk}) = maxcap \\
\forall j \in M \setminus \{ 1,2 \} & \\
 & \sum_{k \in G} (z_{(j-1)k} + \hat{x}_{(j-1)k}) - \sum_{i \in P_j} b_{ijk} g_{ijk} + z_{jk} = maxcap
\end{matrix}$$


\newpage

## Fungsi Objektif

Permasalahan yang dihadapi adalah pemilihan _supplier_ dan BB sebagai berikut:

$$\min \sum_{k \in G} c_k x_k$$

$$\begin{matrix}
\text{terhadap kendala I sampai VI dan } \\
x_k = 0 \text{ atau } \epsilon_k \leq x_k \leq maxcap, \space x_k \in \mathbb{Z}^+ \\
y_k \in \{ 0,1 \}, \hat{x}_{jk} \geq 0, a_{ijk} \in \{ 0,1 \} \\
0 \leq b_{ijk} \leq 1 \\
0 \leq z_{jk} \leq maxcap \\
\end{matrix}$$






