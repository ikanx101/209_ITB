---
title: "Soal Latihan"
output: 
  github_document:
    pandoc_args: --webtex
---

```{r,include = FALSE}
options(digit = 6)
rm(list=ls())
library(dplyr)
library(ggplot2)
```

# SOAL

Temukan akar persamaan berikut:

$$(x-1) \tan{x} + x \sin{\pi x} = 0, x \in [0,1]$$

Dengan keakuratan hingga $10^{-5}$ menggunakan metode _Bisection_ dan _Newton-Rhapson_.

# Jawab

Pertama-tama, kita akan gambarkan terlebih dahulu fungsinya di selang tersebut:

```{r,echo=FALSE,fig.retina = 10,fig.align = "center"}
x = seq(0,1,by = 0.025)
f = function(x){(x-1)*tan(x) + x * sin(x*pi)}
y = f(x)

data.frame(x,y) %>%
  ggplot(aes(x,y)) +
  geom_line(color = "blue") +
  theme_minimal() +
  labs(title = "Fungsi f(x)") +
  geom_hline(yintercept = 0,color = "black")

```

Terlihat dari gambar di atas bahwa akar persamaan terletak di antara $[0.25,0.5]$.

## Metode Bisection

Pemilihan selang ini menjadi hal terpenting bagi metode _Bisection_ agar hasilnya konvergen.

Mari kita selesaikan:

```{r,message=FALSE,warning=FALSE}
# informasi awal
a = 0.25
b = 0.5
iter_max = 100
tol_max = 10^(-5)
i = 0

hasil = data.frame(n = NA,a = NA,b = NA,c = NA)

while(i <= iter_max && (b-a)/2 > tol_max){
  p = a + ((b-a)/2)
  FP = f(p)
  FA = f(a)
  FB = f(b)
  hasil[i+1,] = list(i,a,b,p)
  if(FA*FP < 0){b = p} else {a = p}
  i = i+1
}

hasil %>% knitr::kable()
```

Nilai `c` adalah akar persamaan yang kita cari.

## Metode Newton Rhapson

Pada metode ini, mencari turunan pertama dari $f(x)$ adalah sangat penting. Oleh karena itu, kita perlu melakukannya:

```{r,message = FALSE,warning = FALSE}
library(Ryacas)
eq = "(x-1)*Tan(x) + x * Sin(x*Pi)"
eq %>% y_fn("D(x)") %>% yac_str()
```

Kita telah mendapatkan $f'(x)$. Setelah itu, kita akan set titik iterasi awalnya $x_0 = 0.5$.

```{r}
# initial condition
df = function(x){(x-1)/cos(x)^2+tan(x)+x*pi*cos(x*pi)+sin(x*pi)}
x_0 = 0.5
p = 100 # nilai dummy
i = 1

hasil = data.frame(iter = 0,
		   p = x_0)

while(i <= iter_max && abs(p-x_0) > tol_max){
  p = x_0 - (f(x_0) / df(x_0))
  hasil[i+1,] = list(i,p)
  x_0 = p
  i = i + 1
}

hasil %>% knitr::kable()
```
